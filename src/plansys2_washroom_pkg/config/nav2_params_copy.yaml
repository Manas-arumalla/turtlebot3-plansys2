# Minimal, launch-friendly Nav2 params for TurtleBot3 (each top-level key is a node)
# Save as: ~/plansys2_tb3_ws_new/src/plansys2_washroom_pkg/config/nav2_params.yaml

/amcl:
  ros__parameters:
    use_sim_time: true
    odom_frame_id: "odom"
    base_frame_id: "base_footprint"
    global_frame_id: "map"
    min_particles: 500
    max_particles: 2000

/map_server:
  ros__parameters:
    use_sim_time: true
    yaml_filename: ""   # set on launch via launch arg

/global_costmap:
  ros__parameters:
    use_sim_time: true
    global_frame: "map"
    robot_base_frame: "base_footprint"
    update_frequency: 1.0
    publish_frequency: 0.5
    width: 10.0
    height: 10.0
    resolution: 0.05
    rolling_window: false
    plugins: ["static_layer"]
  # static_layer must go under ros__parameters as nested map:
  # (keep plugin name and params here if you later reintroduce them)

/local_costmap:
  ros__parameters:
    use_sim_time: true
    global_frame: "odom"
    robot_base_frame: "base_footprint"
    update_frequency: 5.0
    publish_frequency: 2.0
    width: 6.0
    height: 6.0
    resolution: 0.05
    rolling_window: true
    plugins: ["obstacle_layer"]

/planner_server:
  ros__parameters:
    use_sim_time: true
    expected_planner_frequency: 20.0
    planner_plugins: ["GridBased"]
    planner_plugin_ids: ["GridBased"]
    GridBased:
      plugin: "nav2_navfn_planner/NavfnPlanner"

/controller_server:
  ros__parameters:
    use_sim_time: true
    controller_plugins: ["FollowPath"]
    FollowPath:
      plugin: "nav2_regulated_pure_pursuit_controller::RegulatedPurePursuitController"
      lookahead_time: 0.4
      min_lookahead_distance: 0.1
      max_lookahead_distance: 0.8
      allow_reversing: false
      controller_frequency: 20.0

/bt_navigator:
  ros__parameters:
    use_sim_time: true
    default_nav_to_pose_bt_xml: "/opt/ros/humble/share/nav2_bt_navigator/behavior_trees/navigate_w_replanning_and_recovery.xml"
    default_nav_through_poses_bt_xml: "/opt/ros/humble/share/nav2_bt_navigator/behavior_trees/navigate_through_poses_w_replanning.xml"

/lifecycle_manager:
  ros__parameters:
    use_sim_time: true
    autostart: true
    node_names:
      - /map_server
      - /amcl
      - /planner_server
      - /controller_server
      - /bt_navigator
